## API Report File for "@backstage/backend-plugin-manager"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
import { BackendFeature } from '@backstage/backend-plugin-api';
import { BackstagePackageJson } from '@backstage/cli-node';
import { CatalogBuilder } from '@backstage/plugin-catalog-backend';
import { Config } from '@backstage/config';
import { EventBroker } from '@backstage/plugin-events-node';
import { EventsBackend } from '@backstage/plugin-events-backend';
import { FeatureDiscoveryService } from '@backstage/backend-plugin-api/alpha';
import { HttpPostIngressOptions } from '@backstage/plugin-events-node';
import { IdentityApi } from '@backstage/plugin-auth-node';
import { IndexBuilder } from '@backstage/plugin-search-backend-node';
import { Logger } from 'winston';
import { LoggerService } from '@backstage/backend-plugin-api';
import { PackagePlatform } from '@backstage/cli-node';
import { PackageRole } from '@backstage/cli-node';
import { PermissionEvaluator } from '@backstage/plugin-permission-common';
import { PermissionPolicy } from '@backstage/plugin-permission-node';
import { PluginCacheManager } from '@backstage/backend-common';
import { PluginDatabaseManager } from '@backstage/backend-common';
import { PluginEndpointDiscovery } from '@backstage/backend-common';
import { PluginTaskScheduler } from '@backstage/backend-tasks';
import { Router } from 'express';
import { ServiceFactory } from '@backstage/backend-plugin-api';
import { ServiceRef } from '@backstage/backend-plugin-api';
import { TaskRunner } from '@backstage/backend-tasks';
import { TemplateAction } from '@backstage/plugin-scaffolder-node';
import { TokenManager } from '@backstage/backend-common';
import { UrlReader } from '@backstage/backend-common';

// @public (undocumented)
export interface BackendDynamicPlugin extends BaseDynamicPlugin {
  // (undocumented)
  installer: BackendDynamicPluginInstaller;
  // (undocumented)
  platform: 'node';
}

// @public (undocumented)
export type BackendDynamicPluginInstaller =
  | LegacyBackendPluginInstaller
  | NewBackendPluginInstaller;

// @public (undocumented)
export interface BackendPluginProvider {
  // (undocumented)
  backendPlugins(): BackendDynamicPlugin[];
}

// @public (undocumented)
export interface BaseDynamicPlugin {
  // (undocumented)
  name: string;
  // (undocumented)
  platform: PackagePlatform;
  // (undocumented)
  role: PackageRole;
  // (undocumented)
  version: string;
}

// @public (undocumented)
export type DynamicPlugin = FrontendDynamicPlugin | BackendDynamicPlugin;

// @public (undocumented)
export interface DynamicPluginsFactoryOptions {
  // (undocumented)
  moduleLoader?(logger: LoggerService): ModuleLoader;
}

// @public (undocumented)
export const dynamicPluginsFeatureDiscoveryServiceFactory: () => ServiceFactory<
  FeatureDiscoveryService,
  'root'
>;

// @public (undocumented)
export const dynamicPluginsServiceFactory: (
  options?: DynamicPluginsFactoryOptions | undefined,
) => ServiceFactory<BackendPluginProvider, 'root'>;

// @public (undocumented)
export const dynamicPluginsServiceRef: ServiceRef<
  BackendPluginProvider,
  'root'
>;

// @public (undocumented)
export interface FrontendDynamicPlugin extends BaseDynamicPlugin {
  // (undocumented)
  platform: 'web';
}

// @public (undocumented)
export function isBackendDynamicPluginInstaller(
  obj: any,
): obj is BackendDynamicPluginInstaller;

// @public @deprecated (undocumented)
export interface LegacyBackendPluginInstaller {
  // (undocumented)
  catalog?(builder: CatalogBuilder, env: LegacyPluginEnvironment): void;
  // (undocumented)
  events?(
    eventsBackend: EventsBackend,
    env: LegacyPluginEnvironment,
  ): HttpPostIngressOptions[];
  // (undocumented)
  kind: 'legacy';
  // (undocumented)
  permissions?: {
    policy?: PermissionPolicy;
  };
  // (undocumented)
  router?: {
    pluginID: string;
    createPlugin(env: LegacyPluginEnvironment): Promise<Router>;
  };
  // (undocumented)
  scaffolder?(env: LegacyPluginEnvironment): TemplateAction<any>[];
  // (undocumented)
  search?(
    indexBuilder: IndexBuilder,
    schedule: TaskRunner,
    env: LegacyPluginEnvironment,
  ): void;
}

// @public @deprecated (undocumented)
export type LegacyPluginEnvironment = {
  logger: Logger;
  cache: PluginCacheManager;
  database: PluginDatabaseManager;
  config: Config;
  reader: UrlReader;
  discovery: PluginEndpointDiscovery;
  tokenManager: TokenManager;
  permissions: PermissionEvaluator;
  scheduler: PluginTaskScheduler;
  identity: IdentityApi;
  eventBroker: EventBroker;
  pluginProvider: BackendPluginProvider;
};

// @public (undocumented)
export interface ModuleLoader {
  // (undocumented)
  bootstrap(backstageRoot: string, dynamicPluginPaths: string[]): Promise<void>;
  // (undocumented)
  load(id: string): Promise<any>;
}

// @public (undocumented)
export interface NewBackendPluginInstaller {
  // (undocumented)
  install(): BackendFeature | BackendFeature[];
  // (undocumented)
  kind: 'new';
}

// @public (undocumented)
export class PluginManager implements BackendPluginProvider {
  // (undocumented)
  addBackendPlugin(plugin: BackendDynamicPlugin): void;
  // (undocumented)
  get availablePackages(): ScannedPluginPackage[];
  // (undocumented)
  backendPlugins(): BackendDynamicPlugin[];
  // (undocumented)
  static fromConfig(
    config: Config,
    logger: LoggerService,
    preferAlpha?: boolean,
    moduleLoader?: ModuleLoader,
  ): Promise<PluginManager>;
  // (undocumented)
  readonly plugins: DynamicPlugin[];
}

// @public (undocumented)
export type ScannedPluginManifest = BackstagePackageJson &
  Required<Pick<BackstagePackageJson, 'main'>> &
  Required<Pick<BackstagePackageJson, 'backstage'>> & {
    backstage: Required<BackstagePackageJson['backstage']>;
  };

// @public (undocumented)
export interface ScannedPluginPackage {
  // (undocumented)
  location: URL;
  // (undocumented)
  manifest: ScannedPluginManifest;
}

// (No @packageDocumentation comment for this package)
```
